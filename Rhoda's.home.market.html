<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RHODA'S HOME MARKET | Premium Selection</title>
    
    <style>
        :root { 
            --warm-cream: #FDFBF7; 
            --forest-green: #1B3022; 
            --soft-gold: #C5A059;
            --deep-gold: #997B39;
            --text-dark: #2C2C2C; 
            --white: #ffffff;
            --shadow: 0 4px 15px rgba(27, 48, 34, 0.1);
        }
        
        body { 
            font-family: 'Segoe UI', serif; 
            margin: 0; 
            padding: 15px 15px 80px 15px; 
            background-color: var(--warm-cream); 
            color: var(--text-dark); 
            line-height: 1.6;
        }
        
        header { 
            text-align: center; 
            padding: 30px 0; 
            border-bottom: 1px solid var(--soft-gold);
            margin-bottom: 20px;
        }

        h1 { color: var(--forest-green); margin: 0; font-size: 1.8rem; font-family: 'Georgia', serif; letter-spacing: 2px; text-transform: uppercase; }
        header p { font-style: italic; color: var(--deep-gold); margin-top: 5px; font-size: 0.9rem; }

        .search-container { max-width: 600px; margin: 0 auto 20px auto; }
        .search-input { width: 100%; padding: 12px 20px; border: 1px solid var(--soft-gold); border-radius: 25px; background: var(--white); font-size: 16px; outline: none; box-shadow: var(--shadow); box-sizing: border-box; }

        .menu-scroll { display: flex; overflow-x: auto; gap: 10px; padding: 5px 0; scrollbar-width: none; margin-bottom: 10px; }
        .menu-scroll::-webkit-scrollbar { display: none; }

        .cat-btn { 
            background: var(--white); border: 1px solid var(--soft-gold); padding: 8px 18px; 
            border-radius: 4px; color: var(--forest-green); font-weight: 600; cursor: pointer; white-space: nowrap; transition: 0.3s;
        }
        .cat-btn.active { background: var(--forest-green); color: var(--warm-cream); border-color: var(--forest-green); }

        #submenu-container { 
            background: rgba(197, 160, 89, 0.1); 
            padding: 10px; 
            border-radius: 8px; 
            margin-bottom: 20px; 
            display: none; 
        }
        .sub-btn { 
            background: transparent; border: 1px dashed var(--soft-gold); padding: 6px 14px; 
            border-radius: 20px; color: var(--deep-gold); font-size: 0.85rem; cursor: pointer; margin-right: 5px; margin-bottom: 5px;
        }
        .sub-btn.active { background: var(--soft-gold); color: white; border-style: solid; }

        .product-card { background: var(--white); padding: 20px; border-radius: 4px; box-shadow: var(--shadow); margin-bottom: 15px; border: 1px solid rgba(197, 160, 89, 0.2); border-left: 4px solid var(--forest-green); }
        
        .category-badge {
            display: inline-block; background: rgba(197, 160, 89, 0.15); color: var(--deep-gold);
            font-size: 0.7rem; padding: 2px 8px; border-radius: 10px; text-transform: uppercase;
            letter-spacing: 0.5px; margin-bottom: 8px; font-weight: bold;
        }

        .card-header { display: flex; justify-content: space-between; font-weight: bold; margin-bottom: 5px; font-family: 'Georgia', serif; color: var(--forest-green); }
        
        .buying-options { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; margin-bottom: 12px; }
        .choice-btn { background: var(--warm-cream); border: 1px solid #e0d8c3; padding: 8px 2px; border-radius: 2px; font-size: 10px; color: var(--forest-green); cursor: pointer; font-weight: bold; }
        
        .input-label { font-size: 0.8rem; font-weight: bold; color: var(--deep-gold); display: block; margin-bottom: 4px; }
        .input-field { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 2px; margin-bottom: 10px; box-sizing: border-box; font-size: 14px; }
        
        .add-btn { background: var(--forest-green); color: var(--warm-cream); border: none; padding: 12px; border-radius: 2px; width: 100%; font-weight: bold; cursor: pointer; text-transform: uppercase; font-size: 0.9rem; transition: background 0.2s; }
        .add-btn.success { background-color: var(--soft-gold) !important; }

        #checkout-form, #cart { background: var(--white); padding: 20px; border-radius: 4px; margin-top: 25px; box-shadow: var(--shadow); border-top: 3px solid var(--soft-gold); }
        h3 { color: var(--forest-green); font-family: 'Georgia', serif; margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .cart-item { display: block; padding: 10px 0; border-bottom: 1px solid #f9f9f9; font-size: 0.9rem; }
        .cart-row { display: flex; justify-content: space-between; font-weight: bold; align-items: center; }
        .cart-note { font-size: 0.8rem; color: #666; font-style: italic; display: block; margin-top: 2px; }
        .remove-btn { background: none; border: none; color: #e74c3c; cursor: pointer; font-size: 1.2rem; font-weight: bold; margin-left: 10px; }

        #messenger-link { display: block; text-align: center; text-decoration: none; padding: 15px; background: var(--forest-green); color: var(--warm-cream); border-radius: 2px; font-weight: bold; margin-top: 20px; text-transform: uppercase; letter-spacing: 1px; cursor: pointer;}

        .action-bar {
            display: flex; justify-content: space-around; background: var(--forest-green);
            padding: 12px 0; position: fixed; bottom: 0; left: 0; width: 100%;
            z-index: 1000; box-shadow: 0 -2px 15px rgba(0,0,0,0.2);
        }
        .action-btn {
            color: var(--warm-cream); text-decoration: none; font-size: 0.75rem;
            display: flex; flex-direction: column; align-items: center;
            background: none; border: none; cursor: pointer; flex: 1;
        }

        /* CONTACT POPUP STYLES */
        #contact-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); z-index: 2000; align-items: center; justify-content: center;
        }
        .modal-content {
            background: white; padding: 25px; border-radius: 15px; width: 85%; max-width: 320px;
            text-align: center;
        }
        .modal-btn {
            display: block; width: 100%; padding: 14px; margin: 10px 0; border-radius: 10px;
            text-decoration: none; font-weight: bold; color: white; border: none; font-size: 1rem; box-sizing: border-box;
        }
        .btn-call { background: #27ae60; }
        .btn-sms { background: #2980b9; }
        .btn-msg { background: #0084FF; }
        .btn-close { background: #eee; color: #333; margin-top: 10px; }
    </style>
</head>
<body>

    <header>
        <h1>Rhoda's Home Market</h1>
        <p>Premium Fresh Meats & Seafood Concierge</p>
    </header>

    <div class="search-container">
        <input type="text" class="search-input" id="search-bar" placeholder="Search items..." onkeyup="handleSearch()">
    </div>

    <div class="menu-scroll">
        <button class="cat-btn active" onclick="setCategory('All', this)">All</button>
        <button class="cat-btn" onclick="setCategory('Pork', this)">Pork</button>
        <button class="cat-btn" onclick="setCategory('Beef', this)">Beef</button>
        <button class="cat-btn" onclick="setCategory('Chicken', this)">Chicken</button>
        <button class="cat-btn" onclick="setCategory('Seafood', this)">Seafood</button>
    </div>

    <div id="submenu-container">
        <div id="submenu-list" class="menu-scroll"></div>
    </div>

    <main id="product-list"></main>

    <div id="checkout-form">
        <h3>Delivery Details</h3>
        <input type="text" id="customer-address" class="input-field" placeholder="Barangay, Street, House No." oninput="saveAddress()">
        <select id="delivery-method" class="input-field" onchange="updateTotal()">
            <option value="0">Boutique Pickup (â‚±0)</option>
            <option value="50">Local Delivery (â‚±50)</option>
            <option value="100">Extended Area (â‚±100)</option>
        </select>
    </div>

    <section id="cart">
        <h3>Your Selection</h3>
        <div id="cart-items"><p style="text-align:center; color:#999;">Empty basket</p></div>
        <div style="margin-top:15px; font-size: 1.2rem; font-weight: bold; text-align: right; border-top: 1px solid var(--soft-gold); padding-top: 10px;">
            Total: â‚±<span id="grand-total">0.00</span>
        </div>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
            <button onclick="clearCart()" style="background:none; border:none; color:var(--deep-gold); cursor:pointer; font-size:11px; text-decoration:underline;">Clear Basket</button>
        </div>
        <a id="messenger-link" onclick="handleOrder(event)">Place Order via Messenger</a>
    </section>

    <div class="action-bar">
        <a href="https://m.me/Johnragebelleza06" class="action-btn" target="_blank">
            <span>ðŸ’¬</span>
            <span>Inquiry</span>
        </a>
        <button class="action-btn" onclick="shareSite()">
            <span>ðŸ”—</span>
            <span>Share Link</span>
        </button>
        <button class="action-btn" onclick="showContactOptions()"> 
            <span>ðŸ“ž</span>
            <span>Contact Us</span>
        </button>
    </div>

    <div id="contact-modal" onclick="closeContactOptions()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h3 style="margin-top: 0;">How to reach us?</h3>
            <a href="tel:09385897143" class="modal-btn btn-call">Call 09385897143</a>
            <a href="sms:09385897143" class="modal-btn btn-sms">Send SMS / Text</a>
            <a href="https://m.me/Johnragebelleza06" class="modal-btn btn-msg" target="_blank">Messenger Chat</a>
            <button class="modal-btn btn-close" onclick="closeContactOptions()">Cancel</button>
        </div>
    </div>

    <script>
        const messengerUsername = "Johnragebelleza06"; 

        const products = [
            { id: 1, cat: "Pork", sub: "Standard", name: "Pork Liempo", price: 395 },
            { id: 2, cat: "Pork", sub: "Standard", name: "Pork Pigue", price: 340 },
            { id: 3, cat: "Pork", sub: "Standard", name: "Pork Kasim", price: 345 },
            { id: 4, cat: "Pork", sub: "Standard", name: "Pork Ribs", price: 320 },
            { id: 5, cat: "Beef", sub: "Beef Items", name: "Laman", price: 450 },
            { id: 6, cat: "Beef", sub: "Beef Items", name: "Buto-buto", price: 350 },
            { id: 7, cat: "Beef", sub: "Beef Items", name: "Bone Marrow", price: 400 },
            { id: 8, cat: "Beef", sub: "Beef Items", name: "Oxtripe (Twalya)", price: 380 },
            { id: 9, cat: "Chicken", sub: "Parts", name: "Chicken Thigh", price: 210 },
            { id: 10, cat: "Chicken", sub: "Parts", name: "Chicken Wings", price: 220 },
            { id: 13, cat: "Seafood", sub: "Fish", name: "Tilapia", price: 160 },
            { id: 14, cat: "Seafood", sub: "Fish", name: "Hito", price: 180 },
            { id: 15, cat: "Seafood", sub: "Fish", name: "Bangus", price: 240 },
            { id: 16, cat: "Seafood", sub: "Fish", name: "Galonggong", price: 200 },
            { id: 17, cat: "Seafood", sub: "Fish", name: "Tuna", price: 480 },
            { id: 18, cat: "Seafood", sub: "Others", name: "Tahong", price: 120 },
            { id: 19, cat: "Seafood", sub: "Others", name: "Hipon", price: 550 },
            { id: 20, cat: "Seafood", sub: "Others", name: "Crab", price: 650 },
            { id: 21, cat: "Seafood", sub: "Others", name: "Squid", price: 420 }
        ];

        let cart = JSON.parse(localStorage.getItem('rhoda_cart')) || [];
        let currentCat = "All";
        let currentSub = "All";
        let searchQuery = "";

        function saveCartState() { localStorage.setItem('rhoda_cart', JSON.stringify(cart)); updateTotal(); }
        function saveAddress() { localStorage.setItem('rhoda_address', document.getElementById('customer-address').value); }
        function showContactOptions() { document.getElementById('contact-modal').style.display = 'flex'; }
        function closeContactOptions() { document.getElementById('contact-modal').style.display = 'none'; }

        function setCategory(cat, btn) {
            currentCat = cat; currentSub = "All";
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderSubmenu(); renderProducts();
        }

        function renderSubmenu() {
            const container = document.getElementById('submenu-container');
            const list = document.getElementById('submenu-list');
            if (currentCat === "All") { container.style.display = "none"; return; }
            const subs = [...new Set(products.filter(p => p.cat === currentCat).map(p => p.sub))];
            container.style.display = "block";
            list.innerHTML = `<button class="sub-btn active" onclick="setSub('All', this)">All ${currentCat}</button>` + 
                subs.map(s => `<button class="sub-btn" onclick="setSub('${s}', this)">${s}</button>`).join('');
        }

        function setSub(sub, btn) {
            currentSub = sub;
            document.querySelectorAll('.sub-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderProducts();
        }

        function renderProducts() {
            const list = document.getElementById('product-list');
            const filtered = products.filter(p => {
                const matchesCat = currentCat === "All" || p.cat === currentCat;
                const matchesSub = currentSub === "All" || p.sub === currentSub;
                const matchesSearch = p.name.toLowerCase().includes(searchQuery.toLowerCase());
                return matchesCat && matchesSub && matchesSearch;
            });

            list.innerHTML = filtered.map(p => `
                <div class="product-card">
                    <span class="category-badge">${p.cat}</span>
                    <div class="card-header"><span>${p.name}</span><span>â‚±${p.price}/kg</span></div>
                    <div class="buying-options">
                        <button class="choice-btn" onclick="addFixed(${p.id}, 1)">1kg</button>
                        <button class="choice-btn" onclick="addFixed(${p.id}, 0.5)">0.5kg</button>
                        <button class="choice-btn" onclick="addFixed(${p.id}, 0.25)">0.25kg</button>
                        <button class="choice-btn" onclick="addFixed(${p.id}, 0.125)">0.125kg</button>
                    </div>
                    <input type="number" class="input-field" id="budget-${p.id}" placeholder="Custom Peso amount">
                    <input type="text" class="input-field" id="note-${p.id}" placeholder="Special instructions">
                    <button class="add-btn" id="btn-${p.id}" onclick="addWithNote(${p.id})">Add to Basket</button>
                </div>
            `).join('');
        }

        function handleSearch() { searchQuery = document.getElementById('search-bar').value; renderProducts(); }

        function addFixed(id, weight) {
            const p = products.find(x => x.id === id);
            const note = document.getElementById(`note-${id}`).value;
            cart.push({ name: p.name, desc: weight + "kg", price: p.price * weight, note: note });
            saveCartState(); feedback(id);
        }

        function addWithNote(id) {
            const p = products.find(x => x.id === id);
            const budgetVal = document.getElementById(`budget-${id}`).value;
            const note = document.getElementById(`note-${id}`).value;
            if(!budgetVal || budgetVal <= 0) return alert("Enter amount.");
            cart.push({ name: p.name, desc: "â‚±" + budgetVal, price: parseFloat(budgetVal), note: note });
            saveCartState(); feedback(id);
        }

        function feedback(id) {
            const btn = document.getElementById(`btn-${id}`);
            btn.innerText = "âœ“ Added"; btn.classList.add('success');
            setTimeout(() => { btn.innerText = "Add to Basket"; btn.classList.remove('success'); }, 800);
        }

        function removeItem(index) { cart.splice(index, 1); saveCartState(); }

        function updateTotal() {
            const itemsTotal = cart.reduce((sum, item) => sum + item.price, 0);
            const delivery = parseFloat(document.getElementById('delivery-method').value);
            document.getElementById('grand-total').innerText = (itemsTotal + delivery).toLocaleString();
            const cartDiv = document.getElementById('cart-items');
            cartDiv.innerHTML = cart.length ? cart.map((item, index) => `
                <div class="cart-item">
                    <div class="cart-row"><span>${item.name} (${item.desc})</span><span>â‚±${item.price.toFixed(2)} <button class="remove-btn" onclick="removeItem(${index})">&times;</button></span></div>
                </div>
            `).join('') : `<p style="text-align:center; color:#999;">Empty basket</p>`;
        }

        function clearCart() { if(confirm("Clear?")) { cart = []; saveCartState(); } }

        function shareSite() {
            if (navigator.share) { navigator.share({ title: "Rhoda's Market", url: window.location.href }); }
            else { alert("Copy link: " + window.location.href); }
        }

        // UPDATED: Most reliable Messenger redirection logic
        async function handleOrder(e) {
            e.preventDefault();
            const addr = document.getElementById('customer-address').value;
            if(!cart.length || !addr) return alert("Please add items and your address!");
            
            let orderSummary = "âœ¨ RHODA'S MARKET ORDER âœ¨\n\n";
            cart.forEach(i => {
                orderSummary += `â€¢ ${i.name} (${i.desc}) - P${i.price.toFixed(2)}\n`;
                if(i.note) orderSummary += `  Note: ${i.note}\n`;
            });
            orderSummary += `\nðŸ  Address: ${addr}`;
            orderSummary += `\nðŸ’° Total: P${document.getElementById('grand-total').innerText}`;
            
            // Step 1: Force Copy to Clipboard
            try {
                const type = "text/plain";
                const blob = new Blob([orderSummary], { type });
                const data = [new ClipboardItem({ [type]: blob })];
                await navigator.clipboard.write(data);
            } catch (err) {
                // Fallback for older browsers
                const textArea = document.createElement("textarea");
                textArea.value = orderSummary;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
            }

            // Step 2: Inform User
            alert("ðŸ“‹ ORDER COPIED!\n\nWe are opening Messenger now. If the box is empty, just PASTE your order.");

            // Step 3: Open Messenger (Standard link is best for auto-fill attempt)
            const messengerUrl = `https://m.me/${messengerUsername}?text=${encodeURIComponent(orderSummary)}`;
            window.open(messengerUrl, '_blank');
        }

        window.onload = () => {
            document.getElementById('customer-address').value = localStorage.getItem('rhoda_address') || '';
            renderProducts(); updateTotal();
        };
    </script>
</body>
</html>
 
